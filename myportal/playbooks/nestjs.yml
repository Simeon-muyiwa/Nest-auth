- name: Delegate Tasks
  hosts: minikube
  vars:
    ansible_user: root
  tasks:
    - name: Print Minikube IP
      debug:
        msg: "Minikube IP is {{ ansible_host }}"

    - name: Verify inventory_hostname
      debug:
        msg: "Current host is: {{ inventory_hostname }}"

    - name: Print Database Connection Details
      debug:
        msg:
          - "Database Host: {{ db_host }}"
          - "Database Port: {{ db_port }}"
          - "Database User: {{ db_user }}"
          - "Database Password: {{ db_password }}"
          - "Database Name: {{ db_name }}"

- name: Deploy NestJS application
  hosts: localhost
  roles:
    - pre-nestjs
    - install-nodejs
    - nestjs-deploy
    - nestjs-service-setup
    - postgresql
    - redis
